'''
Created on 6 Mar 2020

@author: pipertod
'''
from re import RegexFlag

class RScriptChecker(object):
    '''
    classdocs
    '''

    def __init__(self, base64RegexObject):
        '''
        Constructor
        '''
        self.lines = []
        self.base64RegexObject = base64RegexObject
        self.base64KeywordFoundInFile = False
        self.suspicious = False
        self.language = "R"
        self.fileExtensions = ["r"]
        self.archiveExtensions = []
        
    def isFile(self, fileExtension):
        return (fileExtension in self.fileExtensions) 
        
    def isArchive(self, fileExtension):
        return (fileExtension in self.archiveExtensions) 
        
    def getLanguage(self):
        return self.language
        
    def checkLine(self, lineText):
        
        base64Results = self.base64RegexObject.search(lineText, RegexFlag.IGNORECASE)
        
        # Record the line in the file that mentions base64
        if base64Results:
            self.base64KeywordFoundInFile = True
            self.suspicious = True
            self.lines.append(lineText)
                
            
    def isSuspicious(self):
        return self.suspicious
    
    def getLines(self):
        return self.lines
        
        
        