'''
Created on 12 Mar 2020

@author: pipertod
'''
class FileCheckResponse(object):
    '''
    classdocs
    '''


    def __init__(self):
        '''
        Constructor
        '''
        self.fileCount = 0
        self.malwareFileCount = 0
        self.suspiciousFileCount = 0
        self.noReputationFileCount = 0
        self.cleanFileCount = 0
        
        self.cleanFiles = {}
        self.suspiciousFiles = {}
        self.suspiciousFilesDetected = False
        self.noReputationDetected = False
        self.noReputationFiles = {}
        self.malwareDetected = False
        self.malwareFiles = {}
        
    def isSuspiciousFileDetected(self):
        return self.suspiciousFilesDetected
    
    def isMalwareFilesDetected(self):
        return self.malwareDetected
    
    def isNoReputationFilesDetected(self):
        return self.noReputationDetected
            
    def getFileCheck(self, filepath):
        if filepath in self.malwareFiles:
            return self.malwareFiles[filepath]
        elif filepath in self.suspiciousFiles:
            return self.suspiciousFiles[filepath]
        elif filepath in self.noReputationFiles:
            return self.noReputationFiles[filepath]
        elif filepath in self.cleanFiles:
            return self.cleanFiles[filepath]
        else:
            return None
    
    def addFileCheck(self, fileCheck):
        filepath = fileCheck.getFilepath()
        
        self.fileCount = (self.fileCount + 1)
        
        if fileCheck.isMalware():
            self.malwareFiles[filepath] = fileCheck
            self.malwareDetected = True
            self.malwareFileCount = (self.malwareFileCount + 1)
        elif fileCheck.isSuspicious():
            self.suspiciousFiles[filepath] = fileCheck
            self.suspiciousFilesDetected = True
            self.suspiciousFileCount = (self.suspiciousFileCount + 1)
        elif not fileCheck.isReputation():
            self.noReputationFiles[filepath] = fileCheck
            self.noReputationDetected = True
            self.noReputationFileCount = (self.noReputationFileCount + 1)
        else:
            self.cleanFiles[filepath] = fileCheck
            self.cleanFileCount = (self.cleanFileCount + 1)
                        
        return fileCheck
    
    def getMalwareFiles(self):
        return self.malwareFiles
    
    def getSuspiciousFiles(self):
        return self.suspiciousFiles
    
    def getNoReputationFiles(self):
        return self.noReputationFiles
    
    def getCleanFiles(self):
        return self.cleanFiles