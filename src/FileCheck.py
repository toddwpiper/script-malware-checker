'''
Created on 12 Mar 2020

@author: pipertod
'''
class FileCheck(object):
    '''
    classdocs
    '''


    def __init__(self, filepath):
        '''
        Constructor
        '''
        self.reputationChecks = {}
        self.scriptChecks = {}
        self.archive = False
        self.malware = False
        self.suspicious = False
        self.reputation = False
        self.filepath = filepath
        
    def isSuspicious(self):
        return self.suspicious
    
    def isMalware(self):
        return self.malware
    
    def isReputation(self):
        return self.reputation
    
    def getFilepath(self):
        return self.filepath
        
    def addScriptChecks(self, fileCheckResults):
        
        for fileCheckResult in fileCheckResults:
            filepath = fileCheckResult.getFilepath()
            checkname = fileCheckResult.getCheckName()
            
            if not filepath in self.scriptChecks:
                self.scriptChecks[filepath] = {}
                self.scriptChecks[filepath]['checksPerformed'] = []
                self.scriptChecks[filepath]['suspicious'] = False
                
            checksPerformed = self.scriptChecks[filepath]['checksPerformed']
            checksPerformed.append(checkname)
            
            self.scriptChecks[filepath]['results'] = fileCheckResult

            if fileCheckResult.isSuspicious():
                self.suspicious = True
                self.scriptChecks[filepath]['suspicious'] = True
        
    def addReputationChecks(self, fileCheckResults):
        
        for fileCheckResult in fileCheckResults:
            checkName = fileCheckResult.getCheckName()
            
            if fileCheckResult.isMalware():
                self.malware = True
            elif fileCheckResult.isReputation():
                self.reputation = True
            
            self.reputationChecks[checkName] = fileCheckResult
        
    def setArchive(self, archiveBoolean):
        self.archive = archiveBoolean
        
    def getReputationChecks(self):
        return self.reputationChecks
        
